"ACOUSTIC INDEX")))
data %>%
filter(hour >= 0 & hour <= 24,
site.name %in% site,
index == index.type) %>%
ggplot(aes(x=time, y=value)) +
# mean value for the period of observation
geom_point(aes(colour=period), size = 2, alpha = 0.7) +
scale_color_brewer(palette = "Dark2") +
geom_hline(data = dataset %>% filter(site.name %in% site), aes(yintercept=mean), colour = "#0073ff", alpha = 0.5, linetype="solid", size = 1) +
geom_label_repel(data = dataset %>% filter(site.name %in% site), aes(family = lab.font, label=paste("Mean ACI: ", mean), x=60000, y=mean),colour = lab1.text,fill = lab1.fill,nudge_x = 0,nudge_y = 400,segment.linetype = 1,segment.curvature = -0.1,segment.ncp = 3,segment.angle = 0,alpha = lab.alpha, arrow = arrow(length = unit(0.02, "npc"))) +
geom_smooth(colour="#ffd445", alpha = 0.6) +
geom_point(data = filter(high_tides, site.name == site, index == index.type), aes(x=time, y=value), colour = h.tide, shape=24, size=7, stroke=1, alpha=0.8) +
geom_point(data = filter(low_tides, site.name == site, index == index.type), aes(x=time, y=value), colour = l.tide, shape=25, size=7, stroke=1, alpha=0.8) +
theme_wita() +
theme(axis.title.x=element_blank(),
legend.title = element_blank(),
legend.position = "right") +
ylim(c(y.min, y.max)) +
labs(
subtitle = paste(index.name, "(2022-12-23 to 2022-12-31)"),
y = x.label)
}
# 10. Just the Seagrass meadow with its tide markers
scatter_all_meadow <-
scatter_all(c("Seagrass meadow"),
wita15_overall.stats,
"acoustic_complexity",
1650, 4100)
scatter_all_meadow
h.tide <- "#30022d"
l.tide <- "#190b96"
# 8. Generate scatterplot of all ACI across entire period
# Function for generating all data in a single scatter plot of observations from selected site --
scatter_all <- function(site,
dataset,
index.type,
y.min, y.max){
index.name <- str_replace(index.type, "_", " ") %>%
str_to_title()
x.label <- ifelse(index.type == "acoustic_complexity", "ACI",
ifelse(index.type == "acoustic_diversity", "ADI",
ifelse(index.type == "acoustic_evenness", "AEI",
"ACOUSTIC INDEX")))
data %>%
filter(hour >= 0 & hour <= 24,
site.name %in% site,
index == index.type) %>%
ggplot(aes(x=time, y=value)) +
# mean value for the period of observation
geom_point(aes(colour=period), size = 2, alpha = 0.7) +
scale_color_brewer(palette = "Dark2") +
geom_hline(data = dataset %>% filter(site.name %in% site), aes(yintercept=mean), colour = "#0073ff", alpha = 0.5, linetype="solid", size = 1) +
geom_label_repel(data = dataset %>% filter(site.name %in% site), aes(family = lab.font, label=paste("Mean ACI: ", mean), x=60000, y=mean),colour = lab1.text,fill = lab1.fill,nudge_x = 0,nudge_y = 400,segment.linetype = 1,segment.curvature = -0.1,segment.ncp = 3,segment.angle = 0,alpha = lab.alpha, arrow = arrow(length = unit(0.02, "npc"))) +
geom_smooth(colour="#ffd445", alpha = 0.6) +
geom_point(data = filter(high_tides, site.name == site, index == index.type), aes(x=time, y=value), colour = h.tide, shape=24, size=7, stroke=1, alpha=0.8) +
geom_point(data = filter(low_tides, site.name == site, index == index.type), aes(x=time, y=value), colour = l.tide, shape=25, size=7, stroke=1, alpha=0.8) +
theme_wita() +
theme(axis.title.x=element_blank(),
legend.title = element_blank(),
legend.position = "right") +
ylim(c(y.min, y.max)) +
labs(
subtitle = paste(index.name, "(2022-12-23 to 2022-12-31)"),
y = x.label)
}
# 10. Just the Seagrass meadow with its tide markers
scatter_all_meadow <-
scatter_all(c("Seagrass meadow"),
wita15_overall.stats,
"acoustic_complexity",
1650, 4100)
scatter_all_meadow
ggsave("exports-WITA15/4.WITA_15-ACI_scatter_all_meadow.png", width = 36, height = 24, units = "cm")
scatter_all_fringe <-
scatter_all(c("Reef fringe"),
wita15_overall.stats,
"acoustic_complexity",
1650, 4100)
scatter_all_meadow
ggsave("exports-WITA15/4.WITA_15-ACI_scatter_all_fringe.png", width = 36, height = 24, units = "cm")
scatter_all_fringe <-
scatter_all(c("Reef fringe"),
wita15_overall.stats,
"acoustic_complexity",
1650, 4100)
scatter_all_fringe
ggsave("exports-WITA15/4.WITA_15-ACI_scatter_all_fringe.png", width = 36, height = 24, units = "cm")
# 11. Mean daily ACI with 29/12/2022 highlighted
wita15daily_ACI_29highlighted <-
wita15daily_ACI +
geom_point(data = wita15_daily.stats %>%  filter(date == "2022-12-29", site.name == "Reef fringe", index == "acoustic_complexity"),
aes(x=date, y=mean), size = 7, colour = "#f7550f", shape = 19, stroke = 1, alpha = 0.5) +
geom_label_repel(data = wita15_daily.stats %>% filter(date == "2022-12-29", site.name == "Reef fringe", index == "acoustic_complexity"), aes(family = lab.font, label=paste("Reef fringe, mean ACI: ", mean), x=date, y=mean),colour = lab1.text,fill = lab1.fill,nudge_x = 0,nudge_y = -100,segment.linetype = 1,segment.curvature = -0.1,segment.ncp = 3,segment.angle = 0,alpha = lab.alpha, arrow = arrow(length = unit(0.02, "npc"))) +
geom_point(data = wita15_daily.stats %>%  filter(date == "2022-12-29", site.name == "Seagrass meadow", index == "acoustic_complexity"),
aes(x=date, y=mean), size = 7, colour = "#42f5f5", shape = 19, stroke = 1, alpha = 0.5) +
geom_label_repel(data = wita15_daily.stats %>% filter(date == "2022-12-29", site.name == "Seagrass meadow", index == "acoustic_complexity"), aes(family = lab.font, label=paste("Seagrass meadow, mean ACI: ", mean), x=date, y=mean),colour = lab1.text,fill = lab1.fill,nudge_x = 0,nudge_y = 100,segment.linetype = 1,segment.curvature = -0.1,segment.ncp = 3,segment.angle = 0,alpha = lab.alpha, arrow = arrow(length = unit(0.02, "npc")))
wita15daily_ACI_29highlighted
ggsave("exports-WITA15/5.WITA_15-ACI_both_daily_site_avg_29_highlighted.png", width = 24, height = 12, units = "cm")
# 12. Annotated scatter plot of 29/12/2022 with annotations
# Function for generating single scatter plot of observations from selected site and date range --
scatter_single <- function(site,
date.range,
index.type,
y.min, y.max){
index.name <- str_replace(index.type, "_", " ") %>%
str_to_title()
x.label <- ifelse(index.type == "acoustic_complexity", "ACI",
ifelse(index.type == "acoustic_diversity", "ADI",
ifelse(index.type == "acoustic_evenness", "AEI",
"ACOUSTIC INDEX")))
data %>%
filter(date == date.range,
hour >= 0 & hour <= 24,
site.name %in% site,
index == index.type) %>%
ggplot(aes(x=time, y=value)) +
geom_point(aes(colour=period), size = 2, alpha = 0.7) +
scale_color_brewer(palette = "Dark2") +
#    geom_hline(data = wita15_daily.stats %>% filter(date == date.range), aes(yintercept=mean), colour = "#0073ff", alpha = 0.5, linetype="solid", size = 1) +
#   geom_label_repel(data = wita15_daily.stats %>% filter(date == date.range, site.name %in% site), aes(family = lab.font, label=paste("Mean ACI: ", mean), x=60000, y=mean),colour = lab1.text,fill = lab1.fill,nudge_x = 0,nudge_y = 400,segment.linetype = 1,segment.curvature = -0.1,segment.ncp = 3,segment.angle = 0,alpha = lab.alpha, arrow = arrow(length = unit(0.02, "npc"))) +
geom_smooth(colour="#ffd445", alpha = 0.6) +
geom_point(data = filter(high_tides, date == date.range, site.name %in% site, index == index.type), aes(x=time, y=value), colour = h.tide, shape=24, size=7, stroke=1, alpha=0.8) +
geom_point(data = filter(low_tides, date == date.range, site.name %in% site, index == index.type), aes(x=time, y=value), colour = l.tide, shape=25, size=7, stroke=1, alpha=0.8) +
theme_wita() +
theme(axis.title.x=element_blank(),
legend.title = element_blank(),
legend.position = "right") +
ylim(c(y.min, y.max)) +
labs(
subtitle = paste(" (",date.range, ")", sep=""),
y = x.label)
}
# Define x-axis time params for the rectangle annotation:
rect_data <- data %>%
filter(date == "2022-12-29",
index == "acoustic_complexity")
get_seconds <- function(h, m){
seconds <- (h * 3600) + (m * 60)
return(seconds)
}
time_min_early <- get_seconds(00, 0)
time_max_early <- get_seconds(06, 0)
time_min_middle <- get_seconds(10, 0)
time_max_middle <- get_seconds(16, 0)
time_min_late <- get_seconds(18, 0)
time_max_late <- get_seconds(23, 55)
scatter_20221229 <- scatter_single(c("Seagrass meadow", "Reef fringe"),
"2022-12-29",
"acoustic_complexity",
1650, 3600) +
facet_wrap(~site.name, ncol=2)
scatter_20221229_early <-
scatter_20221229 +
geom_rect(aes(xmin = time_min_early,
xmax = time_max_early,
ymin = 1650,
ymax = 3600),
fill = NA,
colour = "#ff0000",
size = 0.5)
scatter_20221229_early
ggsave("exports-WITA15/5a.WITA_15-ACI_scatter_20221229_early.png", width = 36, height = 24, units = "cm")
scatter_20221229_middle <-
scatter_20221229 +
geom_rect(aes(xmin = time_min_middle,
xmax = time_max_middle,
ymin = 1650,
ymax = 3600),
fill = NA,
colour = "#ff0000",
size = 0.5)
scatter_20221229_middle
ggsave("exports-WITA15/5b.WITA_15-ACI_scatter_20221229_middle.png", width = 36, height = 24, units = "cm")
scatter_20221229_late <-
scatter_20221229 +
geom_rect(aes(xmin = time_min_late,
xmax = time_max_late,
ymin = 1650,
ymax = 3600),
fill = NA,
colour = "#ff0000",
size = 0.5)
scatter_20221229_late
ggsave("exports-WITA15/5c.WITA_15-ACI_scatter_20221229_late.png", width = 36, height = 24, units = "cm")
scatter_20221229 <- scatter_single(c("Seagrass meadow", "Reef fringe"),
"2022-12-29",
"acoustic_complexity",
1650, 3600) +
facet_wrap(~site.name, ncol=2)
scatter_20221229_early <-
scatter_20221229 +
geom_rect(aes(xmin = time_min_early,
xmax = time_max_early,
ymin = 1650,
ymax = 3600),
fill = NA,
colour = "#ff0000",
size = 0.5)
scatter_20221229_early
ggsave("exports-WITA15/6a.WITA_15-ACI_scatter_20221229_early.png", width = 36, height = 24, units = "cm")
scatter_20221229_middle <-
scatter_20221229 +
geom_rect(aes(xmin = time_min_middle,
xmax = time_max_middle,
ymin = 1650,
ymax = 3600),
fill = NA,
colour = "#ff0000",
size = 0.5)
scatter_20221229_middle
ggsave("exports-WITA15/6b.WITA_15-ACI_scatter_20221229_middle.png", width = 36, height = 24, units = "cm")
scatter_20221229_late <-
scatter_20221229 +
geom_rect(aes(xmin = time_min_late,
xmax = time_max_late,
ymin = 1650,
ymax = 3600),
fill = NA,
colour = "#ff0000",
size = 0.5)
scatter_20221229_late
ggsave("exports-WITA15/6c.WITA_15-ACI_scatter_20221229_late.png", width = 36, height = 24, units = "cm")
# We only want Acoustic Complexity for this analysis though, so let's filter the dataset
dataACI <- data %>%
filter(index == "acoustic_complexity")
# Now we'll store the summary stats for the whole period and each day
(wita15_overall.stats <- summary.stats(dataACI, "all"))
(wita15_daily.stats <- summary.stats(dataACI, "daily"))
library(tidyverse)
data <- read_csv("data/mf_beach_and_sheoak.csv")
data
data %>%
filter(index == 'acoustic_diversity')
ad <-
data %>%
filter(index == 'acoustic_diversity')
library(ggplot2)
ad %>%
ggplot() +
geom_point(aes(x = time, y = value)) +
facet_wrap(~date)
ad %>% arrange(desc(value))
creek_data <- read_csv('data/mf_beach_and_sheoak.csv')
ad_creek <-
creek_data %>%
filter(index == 'acoustic_diversity')
ad_creek
ad_creek <-
creek_data %>%
filter(index == 'acoustic_diversity', site.name == 'mf_beach')
ad_creek %>% arrange(desc(value))
ad %>%
ggplot() +
geom_point(aes(x = time, y = value)) +
facet_wrap(~date)
ad_creek %>%
ggplot() +
geom_point(aes(x = time, y = value)) +
facet_wrap(~date)
ad_creek %>%
ggplot() +
geom_histogram(aes(x = value))
# distribution, faceted by day
ad_creek %>%
ggplot() +
geom_histogram(aes(x = value)) +
facet_wrap(~date)
ad_sheoak <-
creek_data %>%
filter(index == 'acoustic_diversity', site.name == 'mf_sheoak')
# VISUALISATIONS
viz_scatter <- function(data) {
data %>%
ggplot() +
geom_point(aes(x = time, y = value)) +
facet_wrap(~date)
}
# CREEK DATA
vis_scatter(data)
# VISUALISATIONS
viz_scatter <- function(data) {
data %>%
ggplot() +
geom_point(aes(x = time, y = value)) +
facet_wrap(~date)
}
vis_dist <- function(data) {
data %>%
ad_creek %>%
ggplot() +
geom_histogram(aes(x = value))
}
# CREEK DATA
viz_scatter(data)
# CREEK DATA
viz_scatter(creek_data)
# CREEK DATA
viz_scatter(ad_creek
# CREEK DATA
viz_scatter(ad_creek)
# CREEK DATA
viz_scatter(ad_creek)
vis_scatter(ad_sheoak)
viz_scatter(ad_sheoak)
viz_scatter(ad_creek)
library(monitoR)
library(seewave)
ad_creek %>%
arrange(value)
ad_creek %>%
arrange(desc(value))
ad_creek %>%
filter(date == '2023-07-08') %>%
arrange(desc(value))
# Visualise the frequency bins of given audio
library(seewave)
library(tuneR)
mf_beach20230708_050000 <- readWave("data-audio/WITA_sup1/mf_beach-AD_0.751-20230708_050000.WAV")
savewav(mf_beach20230708_050000)
data(mf_beach20230708_050000)
spec <- meanspec(mf_beach20230708_050000, f=8000, plot=T)
fbands(spec)
fbands(spec, bands=10)
fbands(spec, bands=5)
fbands(spec, bands=10)
spec <- meanspec(mf_beach20230708_050000, f=16000, plot=T)
fbands(spec, bands=10)
spec <- meanspec(mf_beach20230708_050000, f=16000, plot=T)
?meanspec()
fbands(spec, bands=10)
spec <- meanspec(mf_beach20230708_050000, f=24000, plot=T)
fbands(spec, bands=10)
mf_beach20230708_050000 <- readWave("data-audio/WITA_sup1/mf_beach-AD_0.751-20230708_050000.WAV")
spec <- meanspec(mf_beach20230708_050000, f=24000, plot=T)
fbands(spec, bands=10)
# Visualise the frequency bins of given audio
library(seewave)
library(tuneR)
mf_beach20230708_050000 <- readWave("data-audio/WITA_sup1/mf_beach-AD_0.751-20230708_050000.WAV")
spec <- meanspec(mf_beach20230708_050000, f=24000, plot=T)
fbands(spec, bands=10)
mf_beach20230708_073000 <- readWave("data-audio/WITA_sup1/mf_beach-AD_2.30-20230708_073000.WAV")
spec_050000 <- meanspec(mf_beach20230708_073000, f=24000, plot=T)
fbands(spec, bands=10)
spec_073000 <- meanspec(mf_beach20230708_073000, f=24000, plot=T)
fbands(spec, bands=10)
spec_050000 <- meanspec(mf_beach20230708_050000, f=24000, plot=T)
fbands(spec, bands=10)
mf_beach20230708_050000 <- readWave("data-audio/WITA_sup1/mf_beach-AD_0.751-20230708_050000.WAV")
spec_050000 <- meanspec(mf_beach20230708_050000, f=24000, plot=T)
fbands(spec, bands=10)
spec_050000 <- meanspec(mf_beach20230708_050000, f=24000, plot=T)
fbands(spec, bands=20)
spec_073000 <- meanspec(mf_beach20230708_073000, f=24000, plot=T)
fbands(spec, bands=20)
mf_beach20230708_073000 <- readWave("data-audio/WITA_sup1/mf_beach-AD_2.30-20230708_073000.WAV")
spec_050000 <- meanspec(mf_beach20230708_050000, f=24000, plot=T)
fbands(spec_050000, bands=20)
spec_073000 <- meanspec(mf_beach20230708_073000, f=24000, plot=T)
fbands(spec_073000, bands=20)
spec_050000 <- meanspec(mf_beach20230708_050000, f=24000, plot=T)
fbands(spec_050000, bands=10)
spec_073000 <- meanspec(mf_beach20230708_073000, f=24000, plot=T)
fbands(spec_073000, bands=10)
ad_creek %>%
filter(date == '2023-07-08') %>%
arrange(desc(value))
creek_data <- read_csv('data/mf_beach_and_sheoak.csv')
ad_creek <-
creek_data %>%
filter(index == 'acoustic_diversity', site.name == 'mf_beach')
ad_creek %>%
filter(date == '2023-07-08') %>%
arrange(desc(value))
ad_creek %>%
filter(date == '2023-07-08') %>%
arrange(value)
ad_creek %>%
arrange(value)
ad_creek %>%
filter(date = '2023-07-07', mins = 0, hour = 0)
ad_creek %>%
filter(date == '2023-07-07', mins == 0, hour == 0)
library(soundecology)
?acoustic_diversity
# set threshold
acoustic_diversity(mf_beach20230708_050000, max_freq = 10000, db_threshold = -50,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_050000, max_freq = 10000, db_threshold = -40,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_050000, max_freq = 10000, db_threshold = -30,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -50,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -40,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -30,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -20,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -50,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -40,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -30,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -20,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -10,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -20,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_050000, max_freq = 10000, db_threshold = -20,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_050000, max_freq = 10000, db_threshold = -30,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -30,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -20,
freq_step = 1000, shannon = TRUE)
dynspec(spec_050000, f=8000, plot= T)$amp
dynspec(spec_050000, f=8000, plot= T)
?dynspec()
spec_050000 <- meanspec(mf_beach20230708_050000, f=24000, mel=T, plot=T)
fbands(spec_050000, bands=10, db='db')
fbands(spec_050000, bands=10, dB='db')
?fbands
fbands(spec_050000, bands=10, mel=T)
creek_data_20db <- read_csv('data/mf_beach-ADI-20dbthresh.csv')
library(tidyverse)
creek_data <- read_csv('data/mf_beach_and_sheoak.csv')
creek_data_20db <- read_csv('data/mf_beach-ADI-20dbthresh.csv')
ad_creek <-
creek_data %>%
filter(index == 'acoustic_diversity', site.name == 'mf_beach')
ad_creek_2 <-
creek_data %>%
filter(index == 'acoustic_diversity', site.name == 'mf_beach')
ad_sheoak <-
creek_data %>%
filter(index == 'acoustic_diversity', site.name == 'mf_sheoak')
library(ggplot2)
# VISUALISATIONS
viz_scatter <- function(data) {
data %>%
ggplot() +
geom_point(aes(x = time, y = value)) +
facet_wrap(~date)
}
vis_dist <- function(data) {
data %>%
ad_creek %>%
ggplot() +
geom_histogram(aes(x = value))
}
viz_scatter(ad_creek_2)
viz_scatter(ad_creek)
viz_scatter(ad_creek)
viz_scatter(ad_creek_2)
ad_creek_2 <-
creek_data_20db %>%
filter(index == 'acoustic_diversity', site.name == 'mf_beach')
ad_sheoak <-
creek_data %>%
filter(index == 'acoustic_diversity', site.name == 'mf_sheoak')
viz_scatter(ad_creek)
viz_scatter(ad_creek_2)
ad_creek_2
ad_creek_2 %>%
arrange(desc(value))
ad_creek_2 %>%
arrange(value)
# Visualise the frequency bins of given audio
library(seewave)
library(tuneR)
mf_beach20230702_155000 <- readWave("data-audio/WITA_sup1/mf_beach-AD_0.00_20db_-20230702_155000.WAV")
# set threshold
acoustic_diversity(mf_beach20230702_155000, max_freq = 10000, db_threshold = -20,
freq_step = 1000, shannon = TRUE)
library(soundecology)
# set threshold
acoustic_diversity(mf_beach20230702_155000, max_freq = 10000, db_threshold = -20,
freq_step = 1000, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230702_155000, max_freq = 10000, db_threshold = -20,
freq_step = 200, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230702_155000, max_freq = 10000, db_threshold = -20,
freq_step = 50, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_050000, max_freq = 10000, db_threshold = -20,
freq_step = 50, shannon = TRUE)
# set threshold
acoustic_diversity(mf_beach20230708_073000, max_freq = 10000, db_threshold = -20,
freq_step = 50, shannon = TRUE)
